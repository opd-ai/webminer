<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebMiner - Production Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .production-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .production-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .production-header h1 {
            color: #333;
            margin: 0 0 10px 0;
        }

        .production-header p {
            color: #666;
            margin: 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-production {
            background: #28a745;
            color: white;
        }

        .badge-dev {
            background: #ffc107;
            color: #212529;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .comparison-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .comparison-card h3 {
            margin: 0 0 15px 0;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-card ul {
            margin: 0;
            padding-left: 20px;
        }

        .comparison-card li {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .integration-example {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }

        .integration-example h3 {
            margin: 0 0 15px 0;
            color: #495057;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.4;
        }

        .code-highlight {
            background: #ed8936;
            color: #1a202c;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .benefits-list {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }

        .benefits-list h3 {
            color: #0c5460;
            margin: 0 0 15px 0;
        }

        .benefits-list ul {
            margin: 0;
            color: #0c5460;
        }

        .demo-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .demo-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .demo-btn-primary {
            background: #007bff;
            color: white;
        }

        .demo-btn-primary:hover {
            background: #0056b3;
        }

        .demo-btn-success {
            background: #28a745;
            color: white;
        }

        .demo-btn-success:hover {
            background: #218838;
        }

        .status-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            min-height: 60px;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric-card {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: 600;
            color: #004085;
            margin: 0;
        }

        .metric-label {
            font-size: 12px;
            color: #6c757d;
            margin: 5px 0 0 0;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .performance-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="production-container">
        <div class="production-header">
            <h1>üöÄ WebMiner Production Example</h1>
            <p>Demonstrating the optimized <span class="badge badge-production">Production</span> build</p>
        </div>

        <div class="comparison-grid">
            <div class="comparison-card">
                <h3>üèóÔ∏è Development Build <span class="badge badge-dev">Dev</span></h3>
                <ul>
                    <li><strong>File:</strong> webminer.js</li>
                    <li><strong>Size:</strong> ~88 KB</li>
                    <li><strong>Comments:</strong> Full documentation</li>
                    <li><strong>Formatting:</strong> Human-readable</li>
                    <li><strong>Use Case:</strong> Development, debugging</li>
                </ul>
            </div>
            <div class="comparison-card">
                <h3>‚ö° Production Build <span class="badge badge-production">Prod</span></h3>
                <ul>
                    <li><strong>File:</strong> webminer.min.js</li>
                    <li><strong>Size:</strong> ~53 KB (40% smaller)</li>
                    <li><strong>Comments:</strong> License only</li>
                    <li><strong>Formatting:</strong> Optimized</li>
                    <li><strong>Use Case:</strong> Production deployment</li>
                </ul>
            </div>
        </div>

        <div class="benefits-list">
            <h3>üìà Production Build Benefits</h3>
            <ul>
                <li><strong>Faster Loading:</strong> 40% smaller file size means faster downloads</li>
                <li><strong>Reduced Bandwidth:</strong> Less data usage for your users</li>
                <li><strong>Same Functionality:</strong> All ethical mining features preserved</li>
                <li><strong>CDN Friendly:</strong> Optimized for content delivery networks</li>
                <li><strong>Cache Efficient:</strong> Smaller files = better browser caching</li>
            </ul>
        </div>

        <div class="integration-example">
            <h3>üìã Production Integration</h3>
            <p>Simple script tag integration with the minified version:</p>
            <div class="code-block">
&lt;!-- Production WebMiner Integration --&gt;
&lt;script src="<span class="code-highlight">webminer.min.js</span>" 
        data-pool="wss://your-pool.com"
        data-wallet="YOUR_MONERO_ADDRESS"
        data-throttle="0.25"
        data-auto-start="false"&gt;
&lt;/script&gt;
            </div>
            
            <p>Or programmatic initialization:</p>
            <div class="code-block">
&lt;script src="<span class="code-highlight">webminer.min.js</span>"&gt;&lt;/script&gt;
&lt;script&gt;
const miner = new WebMiner({
    pool: 'wss://your-pool.com',
    wallet: 'YOUR_MONERO_ADDRESS',
    throttle: 0.20,  // 20% CPU usage
    autoStart: false // Always require explicit consent
});

// Start mining with consent
miner.start().then(started =&gt; {
    if (started) {
        console.log('Mining started with user consent');
    }
});
&lt;/script&gt;
            </div>
        </div>

        <div class="integration-example">
            <h3>üîß Test the Production Build</h3>
            <p>This page uses the minified production version. Test all functionality:</p>
            
            <div class="demo-controls">
                <button class="demo-btn demo-btn-primary" onclick="testConsent()">
                    Request Mining Consent
                </button>
                <button class="demo-btn demo-btn-success" onclick="startProductionMining()">
                    Start Mining
                </button>
                <button class="demo-btn demo-btn-primary" onclick="showMiningSettings()">
                    Mining Settings
                </button>
                <button class="demo-btn demo-btn-primary" onclick="checkMiningStatus()">
                    Check Status
                </button>
            </div>

            <div id="production-status" class="status-display">
                Production WebMiner ready. Click buttons above to test functionality.
            </div>
        </div>

        <div class="integration-example">
            <h3>üìä Performance Metrics</h3>
            <div class="performance-metrics" id="performance-metrics">
                <div class="metric-card">
                    <div class="metric-value" id="file-size">53KB</div>
                    <div class="metric-label">File Size</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="load-time">-</div>
                    <div class="metric-label">Load Time</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="hash-rate">0.0</div>
                    <div class="metric-label">Hash Rate (H/s)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="cpu-usage">0%</div>
                    <div class="metric-label">CPU Usage</div>
                </div>
            </div>
        </div>

        <div class="integration-example">
            <h3>üåê Deployment Checklist</h3>
            <div class="benefits-list">
                <ul>
                    <li>‚úÖ Use <code>webminer.min.js</code> for production</li>
                    <li>‚úÖ Configure your mining pool URL and wallet address</li>
                    <li>‚úÖ Set appropriate CPU throttle (10-30% recommended)</li>
                    <li>‚úÖ Test consent flow on your actual domain</li>
                    <li>‚úÖ Verify mobile experience and battery protection</li>
                    <li>‚úÖ Set up Content Security Policy headers</li>
                    <li>‚úÖ Monitor user acceptance rates and performance</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Built with üíú for ethical web mining ‚Ä¢ WebMiner v1.0.0-production</p>
        <p><em>This example uses the optimized production build (webminer.min.js)</em></p>
    </div>

    <!-- WebMiner Production Script -->
    <script src="../webminer.min.js" 
            data-pool="wss://pool.example.com"
            data-wallet="44AFFq5kSiGBoZ4NMDwYtN18obc8AemS33DBLWs3H7otXft3XjrpDtQGv7SqSsaBYBb98uNbr2VBBEt7f2wfn3RVGQBEP3A"
            data-throttle="0.25"
            data-auto-start="false">
    </script>

    <script>
        // Track load time
        const loadStartTime = performance.now();
        
        // Production demo functions
        function updateProductionStatus(message) {
            const statusEl = document.getElementById('production-status');
            const timestamp = new Date().toLocaleTimeString();
            statusEl.textContent = `[${timestamp}] ${message}`;
        }

        function testConsent() {
            updateProductionStatus('Testing consent dialog with production build...');
            
            if (window.MiningConsent) {
                MiningConsent.requestPermission().then(hasConsent => {
                    if (hasConsent) {
                        updateProductionStatus('‚úÖ User granted consent (production build working correctly)');
                    } else {
                        updateProductionStatus('‚ùå User declined consent');
                    }
                });
            } else {
                updateProductionStatus('‚ùå Production build not loaded correctly');
            }
        }

        async function startProductionMining() {
            updateProductionStatus('Starting mining with production build...');
            
            if (window.WebMiner) {
                const success = await WebMiner.start();
                if (success) {
                    updateProductionStatus('‚úÖ Production mining started successfully');
                    startMetricsUpdates();
                } else {
                    updateProductionStatus('‚ùå Mining failed to start (consent required)');
                }
            } else {
                updateProductionStatus('‚ùå WebMiner not available in production build');
            }
        }

        function showMiningSettings() {
            updateProductionStatus('Opening settings dialog...');
            
            if (window.MiningConsent) {
                MiningConsent.showSettingsDialog();
                updateProductionStatus('‚öôÔ∏è Settings dialog opened (production build)');
            } else {
                updateProductionStatus('‚ùå Settings not available');
            }
        }

        function checkMiningStatus() {
            if (window.WebMiner) {
                const isMining = WebMiner.isMining();
                const stats = WebMiner.getStats();
                const consent = window.MiningConsent ? MiningConsent.state.hasConsent : false;
                
                updateProductionStatus(
                    `Status: Mining=${isMining ? '‚úÖ' : '‚ùå'} | ` +
                    `Consent=${consent ? '‚úÖ' : '‚ùå'} | ` +
                    `HashRate=${stats.hashrate.toFixed(1)}H/s | ` +
                    `CPU=${Math.round(stats.cpuUsage)}%`
                );
            } else {
                updateProductionStatus('‚ùå WebMiner not initialized');
            }
        }

        function startMetricsUpdates() {
            setInterval(() => {
                if (window.WebMiner && WebMiner.isMining()) {
                    const stats = WebMiner.getStats();
                    
                    document.getElementById('hash-rate').textContent = stats.hashrate.toFixed(1);
                    document.getElementById('cpu-usage').textContent = Math.round(stats.cpuUsage) + '%';
                }
            }, 2000);
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const loadTime = performance.now() - loadStartTime;
            document.getElementById('load-time').textContent = Math.round(loadTime) + 'ms';
            
            updateProductionStatus('Production WebMiner loaded and ready');
            
            // Verify production build features
            const features = {
                WebMiner: !!window.WebMiner,
                MiningConsent: !!window.MiningConsent,
                PerformanceMonitor: !!window.PerformanceMonitor,
                MobileOptimizer: !!window.MobileOptimizer
            };
            
            const featureCount = Object.values(features).filter(Boolean).length;
            updateProductionStatus(`‚úÖ Production build verified: ${featureCount}/4 core features available`);
        });

        // Update file size display (this would be dynamic in real deployment)
        fetch('../webminer.min.js')
            .then(response => response.text())
            .then(content => {
                const sizeKB = Math.round(content.length / 1024);
                document.getElementById('file-size').textContent = sizeKB + 'KB';
            })
            .catch(() => {
                document.getElementById('file-size').textContent = '~53KB';
            });
    </script>
</body>
</html>